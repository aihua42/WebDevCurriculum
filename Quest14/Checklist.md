# Quest 14. 정적 분석: 타입스크립트와 린트 시스템
이번 퀘스트에서는 타입스크립트와 린트 시스템을 통해 코드에 대한 정적분석의 장점에 대해 알아보겠습니다.

# Topics
* Lint
  * ESLint
* TypeScript

# Resources
* [ESLint](https://eslint.org/)
* [TypeScript](https://www.typescriptlang.org/)

# Checklist
## 코드를 린팅하는 것의 장점은 무엇일까요?
Linting은 프로그램을 실행하지 않고 코드를 분석하는 방법. 소스 코드에서 프로그래밍 방식, 스타일 오류 및 형식화되지 않은 코드를 확인하는 프로세스. 논리적 오류, 사용하지 않는 변수, 빈 if-else 문과 같이 코딩 중에 발생하는 몇 가지 흔한 실수를 식별하는 데 도움이 된다.

린트(lint) 또는 린터(linter)는 소스 코드를 분석하여 프로그램 오류, 버그, 스타일 오류, 의심스러운 구조체에 표시(flag)를 달아놓기 위한 도구들을 가리킨다. 

다른 사람과의 협업을 할때 코드의 형식을 맞추기가 어렵다. 그래서 대부분의 프로그래밍 언어에는 컴파일하는 과정에서 수행되는 Linter가 기본적으로 내장되어 있지만, 자바스크립트는 컴파일 과정이 없는 인터프리터 언어이기 때문에 Linter가 내장되어 있지 않다. 그래서 코드가 실행되는 런타임 환경에서 에러가 발생할 수 있다. 그래서 ESLint와 같은 library의 도움을 받아서 코딩 스타일 가이드라인을 따르지 않은 패턴을 검출하여 사후에 발생할 수 있는 잠재적 문제점을 사전에 발견할 수 있도록 해야 한다. 

린팅하면:
1. Lint 도구의 기능에는 검출 기능과 자동 수정 기능이 존재한다. 린팅은 코드 실행 전에 발생할 수 있는 여러가지 문제점에 대응할 수 있다. 동적이고 느슨한 타입인 JS/TS은 Linting을 수행하여 관련 Lint 에러를 수정해주어야 잠재적 문제를 예방할 수 있으므로 Lint 적용이 필수적이다.  
2. 여러 사람이 작업하므로 달라질 수 있는 코드 스타일을 일관성 있게 수정해주어, Code 품질을 높은 수준으로 유지할 수 있다.

Linter 종류:    

JavaScript - JSLint, JSHint, ESLint;    
Typescript - TSLint, ESLint에 Typescript 룰을 Plugin 형태로 추가.    
최근은 주로 ESLint를 사용하는 추세.

  * ### 린트 규칙은 어떻게 설정하는 것이 좋을까요? 너무 빡빡한 규칙과 너무 헐거운 규칙 사이에서 어떻게 밸런스를 잡아야 할까요?
    현업에서 개발을 할때 다른 사람의 코드를 해독하는 일이 비일비재하다. 따라서 프로젝트에 대한 명확한 린트 규칙 설정은 코드 일관성과 유지 보수성을 보장하기 위한 중요한 단계이다. 

    규칙의 엄격성과 유연성 간의 균형은 프로젝트의 특성, 팀의 성향, 개발자의 경험 수준 등을 고려하여 조절해야 한다. 
    1. 필수 규칙과 권장 규칙 구분: 필수 규칙은 엄격하게 적용하되, 권장 규칙은 선택적으로 활성화 또는 비활성화할수 있게 한다.
    2. 문제 우선순위 결정: 프로젝트의 성격에 따라 어떤 문제가 더 중요한지 결정한다. 보안 문제나 신뢰성에 직결되는 규칙은 더 엄격하게 적용되어야 한다.
    3. 예외 처리: 일부 규칙에 대한 유연성을 제공하고 예외 처리 메커니즘을 마련해야 한다.
    4. 코드 리뷰에서 규칙을 토론하고 피드백을 주고받기: 어떤 규칙이 유용하게 느껴지고 어떤 것이 부담스러운지에 대한 토론이 필요하다.
    5. 주기적인 검토와 개선: 프로젝트가 진행됨에 따라 규칙을 주기적으로 검토하고 개선하는 방향으로 조절해야 한다.
    6. 자동화 사용: 자동화된 도구를 사용하여 규칙을 강제하되, 그와 동시에 자동 서식 지원과 같은 기능을 통해 일관성을 높인다.
    7. 개발자 교육: 새로운 팀 멤버들이나 새로운 개발자들에게 규칙에 대한 교육을 제공하여 프로젝트에 대한 이해와 규칙 준수를 도모해야 한다.

## 타입스크립트는 어떤 언어인가요?
마이크로소프트에서 구현한 JavaScript의 슈퍼셋(Superset) 프로그래밍 언어. 자바스크립트에 타입을 부여한 언어. 자바스크립트와 달리 브라우저에서 실행하려면 파일을 컴파일링 해줘야 하는 정적 타입 언어이다. 확장자로는 .ts를 사용하며, 컴파일의 결과물로 JavaScript 코드를 출력한다. 최종적으로 런타임에서는 이렇게 출력된 JavaScript 코드를 구동시키게 된다. 

  * ### 타입스크립트를 사용했을 때 얻을 수 있는 장점은 무엇인가요?
    정적 타입을 명시할 수 있다는 것이 순수한 자바스크립트와의 가장 큰 차이점이다. 덕분에 개발 도구(IDE나 컴파일러 등)에게 개발자가 의도한 변수나 함수 등의 목적을 더욱 명확하게 전달할 수 있고, 그렇게 전달된 정보를 기반으로 코드 자동 완성이나 잘못된 변수/함수 사용에 대한 에러 알림같은 풍부한 피드백을 받을 수 있게 되므로 순수 자바스크립트에 비해 생산성 향상을 가져다 준다. 즉, '자바스크립트를 실제로 사용하기 전에 있을만한 타입 에러들을 미리 잡는 것' 이 타입스크립트의 사용 목적이다. 

    개발자와 도구 간의 상호작용에서 뿐만 아니라 개발자 간의 상호작용에서도 상당한 이점이 있는데, API를 구현하고 사용함에 있어 해당 API의 인풋과 아웃풋이 무엇인지 명확하게 표현할 수 있으므로, API 하나 쓰는데에도 일일이 매뉴얼을 찾아봐야 하거나 심하면 해당 API의 코드까지 뒤적거려봐야 하는 자바스크립트에 비해 효율적이다.

  * ### 타입스크립트를 사용하면서 타입이 없는 라이브러리나 프레임워크를 사용해야 할 경우에는 어떻게 해야 할까요?
    타입스크립트를 사용하면서 타입이 없는 라이브러리나 프레임워크를 쓰면 빨간 에러 표시가 뜬다. 이러한 에러를 수정하기 위해서 제일 간단한 방법은 타입에 `any`를 선언하는 것이다.
    ```ts
    let func: any = someLibraryFunction();
    ```  

    또는 타입 에러를 무시하고 싶으면 `@ts-expect-error`나 `@ts-ignore` comment로 오류를 억제해줄수 있다. 다만 타입 에러에만 사용해야 한다. 
    ```ts
    // @ts-ignore
    let func = someLibraryFunction();
    ```

    타입 정의 파일(*.d.ts)을 작성하는 방법도 있다. 타입스크립트에서는 타입이 없는 라이브러리나 프레임워크를 위한 타입 정의 파일을 작성할 수 있다. 이 파일은 주로 .d.ts 확장자를 가지며, 외부 라이브러리의 타입 정보를 선언한다. [DefinitelyTyped 프로젝트](https://definitelytyped.org/)에서는 많은 라이브러리의 타입 정의 파일을 제공하고 있다.

    자체적으로 타입 선언을 추가하거나 수정하여 타입 정보를 확장할 수도 있다. 이는 주로 전역 객체에 대한 선언이나 모듈의 타입에 대한 확장 등을 통해 이루어진다. 스키마 `interface`를 사용한다. 다만 이 방법은 라이브러리나 프레임워크의 동작 방식을 우선 이해하고 있어야 한다.
    ```ts
    declare module 'some-library' {
      interface SomeLibraryType {
        // 추가적인 타입 정보
      }
    }
    ```

    또한 특정 변수에 대해 개발자가 해당 타입을 정확히 알고 있을 때, 타입 단언을 사용하여 타입 검사를 무시할 수 있다. 
    ```ts
    let func = someLibraryFunction() as SomeType;
    ```

    타입스크립트가 완전히 대중화가 된 지금 대부분 사용하던 라이브러리가 타입스크립트로 작성이 되어있고, 그렇지 않은 경우도 대부분 `@types` 패키지를 내놓거나 오픈소스로 나오고 있는 형국이다.

    js 코드를 ts 코드로 migrating할때, 무수히 많은 에러를 메꾸기 위해서 any를 남발하고 억지로 Type을 붙이는 것보다, 그냥 `strict`와 `lint`를 잠시 꺼두고, 기존의 개발환경을 무너뜨리지 말고 필요할때 조금씩 자동완성 도구를 같이 꺼내어 쓰는것이 좋다. 그리고 `as`나 `any`가 눈에 많이 띄고 괜히 복잡해 보이는 형태로 코드가 만들어졌다면 잘못된 방식... 
    
    (_Typescript_ = _JavaScript `AutoComplete`_ + _Type 검사용 `plugIn'_)

  * ### any 타입을 남용하는 것은 왜 좋지 않을까요?
    `any` 타입은 TypeScript에서 모든 타입을 허용하는 타입으로, 타입 검사를 피할 수 있게 해주는 유용한 도구이지만, 남용할 경우에는 코드의 안정성과 유지보수성에 문제가 발생할 수 있다. 

    1. TypeScript의 큰 장점 중 하나는 정적 타입 검사를 통해 코드 안정성을 높이는 것인데, `any`를 많이 쓰게 되면 수많은 타입 검사가 무시되면서 코드에서 예기치 못한 런타임 에러가 발생하게 되므로 타입스크립트의 이 장점을 못살리게 된다.
    2. TypeScript는 변수나 함수의 반환값에 대한 타입을 추론할 수 있는데, `any` 타입을 사용하면 이러한 장점을 활용할 수 없게 된다. 이로 인해 코드 작성량이 증가하고 유지보수가 어려워진다.
    3. 타입 정보가 유실되면서 개발자들이 코드를 이해하고 유지보수하는 데에 어려움을 주게 된다.
    4. 타입스크립트에서는 코드 에디터, IDE(통합 개발 환경), 린터 등이 정적 타입 정보를 활용하여 코드 작성을 도와준다. `any`를 남용하면 이러한 도구들이 제공하는 혜택을 제한하게 된다.

    따라서 `any` 타입은 필요한 경우에만 최소한으로 사용하고, 타입 정보를 최대한 활용하여 코드의 안정성과 가독성을 높이는 것이 바람직하다. 만약 외부 라이브러리 등에서 타입 정보를 얻을 수 없는 경우, 타입 정의 파일이나 다른 방법으로 타입 정보를 추가해줘야 한다.

## 린트와 빌드 등의 과정을 개발 싸이클에서 편하게 수행하려면 어떻게 하는 것이 좋을까요?
코드를 원격 저장소에 업로드하기 전에 코딩 컨벤션(규칙)을 지켰는지 확인하는 툴을 사용한다. 코드 린팅 툴을 사용해서 코드가 통합되기 전에 규칙에 맞게 짜여 있는지 확인할수 있다.

린팅 과정을 통과한후 코드 빌드 작업을 거치게 된다. 린팅 툴을 이용해 코드의 외형을 잡아주었다면, 실제로 코드가 잘 동작하는 지를 확인해야 한다. 이때도 툴을 사용한다. 툴을 제공하는 회사의 컴퓨터에서 코드를 빌드해보고 개발자가 짠 테스트 코드도 같이 실행시켜 본다. 이런 코드 빌드 작업과 테스트 코드를 미리 실행시켜 주는 툴을 CI(Continuous Integration) 툴이라고 한다. 

이런 린팅, 빌드, 테스트 등의 작업을 자동화하기 위한 스크립트를 작성할수 있다. `npm scripts`에 자동으로 실행하고 싶은 스크립트를 추가하면 된다.

그리고 커밋을 수행하기 전에 린팅과 테스트를 자동으로 실행하는 git의 pre-commit hook을 등록할수 있다. pre-commit 훅은 커밋할 때 가장 먼저 호출되는 훅으로 커밋 메시지를 작성하기 전에 호출된다. 이를 통해 커밋한 코드가 기본 규칙을 준수하고 빌드 가능한 상태인지를 확인할 수 있다.  
[pre-commit](https://pre-commit.com/) 

Deploy할 때는 CD 툴을 사용할수 있다. CD는 CI의 연장선으로, 이 CI 프로세스를 통과한 코드 버전을 마지막에 “배포”하는 과정을 말한다. 코드 변경 사항이 파이프라인의 이전 단계(CI)를 모두 성공적으로 통과하면 수동 개입 없이 프로덕션에 자동으로 배포됨으로, 신속하고 능률적으로 사용자에게 새로운 기능을 제공할 수 있는 것이 장점이다. 

# Quest
* 메모장 시스템에 린트 시스템을 적용해 보세요.
* 메모장 시스템을 타입스크립트 기반으로 수정해 보세요.
* `package.json` 파일의 `scripts` 항목을 이용하여 린트와 빌드 등의 작업을 스크립트화 해 보세요.
